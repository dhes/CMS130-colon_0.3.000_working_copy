{
  "resourceType": "Library",
  "id": "CumulativeMedicationDuration",
  "extension": [ {
    "url": "http://hl7.org/fhir/uv/crmi/StructureDefinition/crmi-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://ecqi.healthit.gov/ecqms/Library/CumulativeMedicationDuration",
  "version": "5.0.000",
  "name": "CumulativeMedicationDuration",
  "type": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/library-type",
      "code": "logic-library"
    } ]
  },
  "content": [ {
    "contentType": "text/cql",
    "data": "bGlicmFyeSBDdW11bGF0aXZlTWVkaWNhdGlvbkR1cmF0aW9uIHZlcnNpb24gJzUuMC4wMDAnCgp1c2luZyBRSUNvcmUgdmVyc2lvbiAnNi4wLjAnCgppbmNsdWRlIEZISVJIZWxwZXJzIHZlcnNpb24gJzQuNC4wMDAnIGNhbGxlZCBGSElSSGVscGVycwppbmNsdWRlIFFJQ29yZUNvbW1vbiB2ZXJzaW9uICc0LjAuMDAwJwoKLy8gVGhlc2UgY29kZSBzeXN0ZW1zIGFyZSBub3Qga25vd24gdG8gdGhlIE1BVCBlbnZpcm9ubWVudCB5ZXQsIHJlcXVlc3QgdG8gaGF2ZSB0aGVtIGFkZGVkIHN1Ym1pdHRlZApjb2Rlc3lzdGVtICJWM1RpbWluZ0V2ZW50IjogJ2h0dHA6Ly90ZXJtaW5vbG9neS5obDcub3JnL0NvZGVTeXN0ZW0vdjMtVGltaW5nRXZlbnQnCmNvZGVzeXN0ZW0gIkV2ZW50VGltaW5nIjogJ2h0dHA6Ly9obDcub3JnL2ZoaXIvZXZlbnQtdGltaW5nJwoKY29kZSAiSFMiOiAnSFMnIGZyb20gIlYzVGltaW5nRXZlbnQiIC8vIGV2ZW50IG9jY3VycyBbb2Zmc2V0XSBiZWZvcmUgdGhlIGhvdXIgb2Ygc2xlZXAgKG9yIHRyeWluZyB0bykKY29kZSAiV0FLRSI6ICdXQUtFJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLyBldmVudCBvY2N1cnMgW29mZnNldF0gYWZ0ZXIgd2FraW5nCmNvZGUgIkMiOiAnQycgZnJvbSAiVjNUaW1pbmdFdmVudCIgLy8JZXZlbnQgb2NjdXJzIGF0IGEgbWVhbCAoZnJvbSB0aGUgTGF0aW4gY2lidXMpCmNvZGUgIkNNIjogJ0NNJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLwlldmVudCBvY2N1cnMgYXQgYnJlYWtmYXN0IChmcm9tIHRoZSBMYXRpbiBjaWJ1cyBtYXR1dGludXMpCmNvZGUgIkNEIjogJ0NEJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLwlldmVudCBvY2N1cnMgYXQgbHVuY2ggKGZyb20gdGhlIExhdGluIGNpYnVzIGRpdXJudXMpCmNvZGUgIkNWIjogJ0NWJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLwlldmVudCBvY2N1cnMgYXQgZGlubmVyIChmcm9tIHRoZSBMYXRpbiBhbnRlIGNpYnVzIHZlc3BlcnRpbnVzKQpjb2RlICJBQyI6ICdBQycgZnJvbSAiVjNUaW1pbmdFdmVudCIgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSBhIG1lYWwgKGZyb20gdGhlIExhdGluIGFudGUgY2lidXMpCmNvZGUgIkFDTSI6ICdBQ00nIGZyb20gIlYzVGltaW5nRXZlbnQiIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBiZWZvcmUgYnJlYWtmYXN0IChmcm9tIHRoZSBMYXRpbiBhbnRlIGNpYnVzIG1hdHV0aW51cykKY29kZSAiQUNEIjogJ0FDRCcgZnJvbSAiVjNUaW1pbmdFdmVudCIgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSBsdW5jaCAoZnJvbSB0aGUgTGF0aW4gYW50ZSBjaWJ1cyBkaXVybnVzKQpjb2RlICJBQ1YiOiAnQUNWJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLwlldmVudCBvY2N1cnMgW29mZnNldF0gYmVmb3JlIGRpbm5lciAoZnJvbSB0aGUgTGF0aW4gYW50ZSBjaWJ1cyB2ZXNwZXJ0aW51cykKY29kZSAiUEMiOiAnUEMnIGZyb20gIlYzVGltaW5nRXZlbnQiIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBhIG1lYWwgKGZyb20gdGhlIExhdGluIHBvc3QgY2lidXMpCmNvZGUgIlBDTSI6ICdQQ00nIGZyb20gIlYzVGltaW5nRXZlbnQiIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBicmVha2Zhc3QgKGZyb20gdGhlIExhdGluIHBvc3QgY2lidXMgbWF0dXRpbnVzKQpjb2RlICJQQ0QiOiAnUENEJyBmcm9tICJWM1RpbWluZ0V2ZW50IiAvLwlldmVudCBvY2N1cnMgW29mZnNldF0gYWZ0ZXIgbHVuY2ggKGZyb20gdGhlIExhdGluIHBvc3QgY2lidXMgZGl1cm51cykKY29kZSAiUENWIjogJ1BDVicgZnJvbSAiVjNUaW1pbmdFdmVudCIgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGFmdGVyIGRpbm5lciAoZnJvbSB0aGUgTGF0aW4gcG9zdCBjaWJ1cyB2ZXNwZXJ0aW51cykKCmNvZGUgIk1PUk4iOiAnTU9STicgZnJvbSBFdmVudFRpbWluZyAvLwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBtb3JuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgpjb2RlICJNT1JOLmVhcmx5IjogJ01PUk4uZWFybHknIGZyb20gRXZlbnRUaW1pbmcgLy8JRWFybHkgTW9ybmluZwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBlYXJseSBtb3JuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgpjb2RlICJNT1JOLmxhdGUiOiAnTU9STi5sYXRlJyBmcm9tIEV2ZW50VGltaW5nIC8vIExhdGUgTW9ybmluZwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBsYXRlIG1vcm5pbmcuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCmNvZGUgIk5PT04iOiAnTk9PTicgZnJvbSBFdmVudFRpbWluZyAvLwlOb29uCUV2ZW50IG9jY3VycyBhcm91bmQgMTI6MDBwbS4gVGhlIGV4YWN0IHRpbWUgaXMgdW5zcGVjaWZpZWQgYW5kIGVzdGFibGlzaGVkIGJ5IGluc3RpdHV0aW9uIGNvbnZlbnRpb24gb3IgcGF0aWVudCBpbnRlcnByZXRhdGlvbi4KY29kZSAiQUZUIjogJ0FGVCcgZnJvbSBFdmVudFRpbWluZyAvLwlBZnRlcm5vb24JRXZlbnQgb2NjdXJzIGR1cmluZyB0aGUgYWZ0ZXJub29uLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgpjb2RlICJBRlQuZWFybHkiOiAnQUZULmVhcmx5JyBmcm9tIEV2ZW50VGltaW5nIC8vCUVhcmx5IEFmdGVybm9vbglFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBlYXJseSBhZnRlcm5vb24uIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCmNvZGUgIkFGVC5sYXRlIjogJ0FGVC5sYXRlJyBmcm9tIEV2ZW50VGltaW5nIC8vCUxhdGUgQWZ0ZXJub29uCUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIGxhdGUgYWZ0ZXJub29uLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgpjb2RlICJFVkUiOiAnRVZFJyBmcm9tIEV2ZW50VGltaW5nIC8vCUV2ZW5pbmcJRXZlbnQgb2NjdXJzIGR1cmluZyB0aGUgZXZlbmluZy4gVGhlIGV4YWN0IHRpbWUgaXMgdW5zcGVjaWZpZWQgYW5kIGVzdGFibGlzaGVkIGJ5IGluc3RpdHV0aW9uIGNvbnZlbnRpb24gb3IgcGF0aWVudCBpbnRlcnByZXRhdGlvbi4KY29kZSAiRVZFLmVhcmx5IjogJ0VWRS5lYXJseScgZnJvbSBFdmVudFRpbWluZyAvLwlFYXJseSBFdmVuaW5nCUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIGVhcmx5IGV2ZW5pbmcuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCmNvZGUgIkVWRS5sYXRlIjogJ0VWRS5sYXRlJyBmcm9tIEV2ZW50VGltaW5nIC8vCUxhdGUgRXZlbmluZwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBsYXRlIGV2ZW5pbmcuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCmNvZGUgIk5JR0hUIjogJ05JR0hUJyBmcm9tIEV2ZW50VGltaW5nIC8vCU5pZ2h0CUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIG5pZ2h0LiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgpjb2RlICJQSFMiOiAnUEhTJyBmcm9tIEV2ZW50VGltaW5nIC8vCUFmdGVyIFNsZWVwCUV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBzdWJqZWN0IGdvZXMgdG8gc2xlZXAuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCgpjb2RlICJFdmVyeSBlaWdodCBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICczMDc0NjkwMDgnIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgZWlnaHQgaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkV2ZXJ5IGVpZ2h0IHRvIHR3ZWx2ZSBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICczOTYxNDAwMDMnIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgZWlnaHQgdG8gdHdlbHZlIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpJwpjb2RlICJFdmVyeSBmb3J0eSBlaWdodCBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICczOTYxMzEwMDInIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgZm9ydHkgZWlnaHQgaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkV2ZXJ5IGZvcnR5IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIjogJzM5NjEzMDAwMScgZnJvbSBRSUNvcmVDb21tb24uIlNOT01FRENUIiBkaXNwbGF5ICdFdmVyeSBmb3J0eSBob3VycyAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiRXZlcnkgZm91ciBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICcyMjU3NTYwMDInIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgZm91ciBob3VycyAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiRXZlcnkgc2V2ZW50eSB0d28gaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzk2MTQzMDAxJyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHNldmVudHkgdHdvIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpJwpjb2RlICJFdmVyeSBzaXggaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzA3NDY4MDAwJyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHNpeCBob3VycyAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiRXZlcnkgc2l4IHRvIGVpZ2h0IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIjogJzM5NjEzOTAwMCcgZnJvbSBRSUNvcmVDb21tb24uIlNOT01FRENUIiBkaXNwbGF5ICdFdmVyeSBzaXggdG8gZWlnaHQgaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkV2ZXJ5IHRoaXJ0eSBzaXggaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzk2MTI2MDA0JyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHRoaXJ0eSBzaXggaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkV2ZXJ5IHRocmVlIHRvIGZvdXIgaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMjI1NzU0MDA0JyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHRocmVlIHRvIGZvdXIgaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkV2ZXJ5IHRocmVlIHRvIHNpeCBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICczOTYxMjcwMDgnIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgdGhyZWUgdG8gc2l4IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpJwpjb2RlICJFdmVyeSB0d2VsdmUgaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzA3NDcwMDA5JyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHR3ZWx2ZSBob3VycyAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiRXZlcnkgdHdlbnR5IGZvdXIgaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzk2MTI1MDAwJyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0V2ZXJ5IHR3ZW50eSBmb3VyIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpJwpjb2RlICJFdmVyeSB0d28gdG8gZm91ciBob3VycyAocXVhbGlmaWVyIHZhbHVlKSI6ICcyMjU3NTIwMDAnIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnRXZlcnkgdHdvIHRvIGZvdXIgaG91cnMgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIkZvdXIgdGltZXMgZGFpbHkgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzA3NDM5MDAxJyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ0ZvdXIgdGltZXMgZGFpbHkgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIk9uY2UgZGFpbHkgKHF1YWxpZmllciB2YWx1ZSkiOiAnMjI5Nzk3MDA0JyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ09uY2UgZGFpbHkgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIk9uZSB0byBmb3VyIHRpbWVzIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIjogJzM5NjEwOTAwNScgZnJvbSBRSUNvcmVDb21tb24uIlNOT01FRENUIiBkaXNwbGF5ICdPbmUgdG8gZm91ciB0aW1lcyBhIGRheSAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiT25lIHRvIHRocmVlIHRpbWVzIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIjogJzM5NjEwODAwMicgZnJvbSBRSUNvcmVDb21tb24uIlNOT01FRENUIiBkaXNwbGF5ICdPbmUgdG8gdGhyZWUgdGltZXMgYSBkYXkgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIk9uZSB0byB0d28gdGltZXMgYSBkYXkgKHF1YWxpZmllciB2YWx1ZSkiOiAnMzk2MTA3MDA3JyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ09uZSB0byB0d28gdGltZXMgYSBkYXkgKHF1YWxpZmllciB2YWx1ZSknCmNvZGUgIlRocmVlIHRpbWVzIGRhaWx5IChxdWFsaWZpZXIgdmFsdWUpIjogJzIyOTc5ODAwOScgZnJvbSBRSUNvcmVDb21tb24uIlNOT01FRENUIiBkaXNwbGF5ICdUaHJlZSB0aW1lcyBkYWlseSAocXVhbGlmaWVyIHZhbHVlKScKY29kZSAiVHdpY2UgYSBkYXkgKHF1YWxpZmllciB2YWx1ZSkiOiAnMjI5Nzk5MDAxJyBmcm9tIFFJQ29yZUNvbW1vbi4iU05PTUVEQ1QiIGRpc3BsYXkgJ1R3aWNlIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpJwpjb2RlICJUd28gdG8gZm91ciB0aW1lcyBhIGRheSAocXVhbGlmaWVyIHZhbHVlKSI6ICczOTYxMTEwMDEnIGZyb20gUUlDb3JlQ29tbW9uLiJTTk9NRURDVCIgZGlzcGxheSAnVHdvIHRvIGZvdXIgdGltZXMgYSBkYXkgKHF1YWxpZmllciB2YWx1ZSknCgpwYXJhbWV0ZXIgRXJyb3JMZXZlbCBTdHJpbmcgZGVmYXVsdCAnV2FybmluZycKCmNvbnRleHQgUGF0aWVudAoKLyoKIEdvYWwgaXMgdG8gZ2V0IHRvIG51bWJlciBvZiBkYXlzCiBUd28gYnJvYWQgYXBwcm9hY2hlcyB0byB0aGUgY2FsY3VsYXRpb246CiAgMSkgQmFzZWQgb24gc3VwcGx5IGFuZCBmcmVxdWVuY3ksIGNhbGN1bGF0ZSB0aGUgbnVtYmVyIG9mIGV4cGVjdGVkIGRheXMgdGhlIG1lZGljYXRpb24gd2lsbCBjb3Zlci9oYXMgY292ZXJlZAogIDIpIEJhc2VkIG9uIHJlbGV2YW50IHBlcmlvZCwgZGV0ZXJtaW5lIGEgY292ZXJlZCBpbnRlcnZhbCBhbmQgY2FsY3VsYXRlIHRoZSBsZW5ndGggb2YgdGhhdCBpbnRlcnZhbCBpbiBkYXlzClRoaXMgdG9waWMgY292ZXJzIHNldmVyYWwgdXNlIGNhc2VzIGFuZCBpbGx1c3RyYXRlcyBob3cgdG8gY2FsY3VsYXRlIEN1bXVsYXRpdmUKTWVkaWNhdGlvbiBEdXJhdGlvbiBmb3IgZWFjaCB0eXBlIG9mIG1lZGljYXRpb24gcmVzb3VyY2UgdXNpbmcgdGhlIHN1cHBseSBhbmQKZnJlcXVlbmN5IGFwcHJvYWNoLgoqLwoKLyoKICBGb3IgdGhlIGZpcnN0IGFwcHJvYWNoLCB3ZSBuZWVkIHRvIGdldCBmcm9tIGZyZXF1ZW5jeSB0byBhIGZyZXF1ZW5jeS9kYXkKICBTbyB3ZSBkZWZpbmUgVG9EYWlseQoqLwoKLyoKICBDYWxjdWxhdGVzIGRhaWx5IGZyZXF1ZW5jeSBnaXZlbiBmcmVxdWVuY3kgd2l0aGluIGEgcGVyaW9kCiovCmRlZmluZSBmdW5jdGlvbiBUb0RhaWx5KGZyZXF1ZW5jeSBTeXN0ZW0uSW50ZWdlciwgcGVyaW9kIFN5c3RlbS5RdWFudGl0eSk6CiAgY2FzZSBwZXJpb2QudW5pdAogICAgd2hlbiAnaCcgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkKICAgIHdoZW4gJ21pbicgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgKiA2MAogICAgd2hlbiAncycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgKiA2MCAqIDYwCiAgICB3aGVuICdkJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAvIDI0CiAgICB3aGVuICd3aycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgLyAoMjQgKiA3KQogICAgd2hlbiAnbW8nIHRoZW4gZnJlcXVlbmN5ICogKDI0LjAgLyBwZXJpb2QudmFsdWUpIC8gKDI0ICogMzApIC8qIGFzc3VtaW5nIDMwIGRheXMgaW4gbW9udGggKi8KICAgIHdoZW4gJ2EnIHRoZW4gZnJlcXVlbmN5ICogKDI0LjAgLyBwZXJpb2QudmFsdWUpIC8gKDI0ICogMzY1KSAvKiBhc3N1bWluZyAzNjUgZGF5cyBpbiB5ZWFyICovCiAgICB3aGVuICdob3VyJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKQogICAgd2hlbiAnbWludXRlJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAqIDYwCiAgICB3aGVuICdzZWNvbmQnIHRoZW4gZnJlcXVlbmN5ICogKDI0LjAgLyBwZXJpb2QudmFsdWUpICogNjAgKiA2MAogICAgd2hlbiAnZGF5JyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAvIDI0CiAgICB3aGVuICd3ZWVrJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAvICgyNCAqIDcpCiAgICB3aGVuICdtb250aCcgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgLyAoMjQgKiAzMCkgLyogYXNzdW1pbmcgMzAgZGF5cyBpbiBtb250aCAqLwogICAgd2hlbiAneWVhcicgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgLyAoMjQgKiAzNjUpIC8qIGFzc3VtaW5nIDM2NSBkYXlzIGluIHllYXIgKi8KICAgIHdoZW4gJ2hvdXJzJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKQogICAgd2hlbiAnbWludXRlcycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgKiA2MAogICAgd2hlbiAnc2Vjb25kcycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgKiA2MCAqIDYwCiAgICB3aGVuICdkYXlzJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAvIDI0CiAgICB3aGVuICd3ZWVrcycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgLyAoMjQgKiA3KQogICAgd2hlbiAnbW9udGhzJyB0aGVuIGZyZXF1ZW5jeSAqICgyNC4wIC8gcGVyaW9kLnZhbHVlKSAvICgyNCAqIDMwKSAvKiBhc3N1bWluZyAzMCBkYXlzIGluIG1vbnRoICovCiAgICB3aGVuICd5ZWFycycgdGhlbiBmcmVxdWVuY3kgKiAoMjQuMCAvIHBlcmlvZC52YWx1ZSkgLyAoMjQgKiAzNjUpIC8qIGFzc3VtaW5nIDM2NSBkYXlzIGluIHllYXIgKi8KICAgIGVsc2UgTWVzc2FnZShudWxsLCB0cnVlLCAnQ01ETG9naWMuVG9EYWlseS5Vbmtub3duVW5pdCcsIEVycm9yTGV2ZWwsICdVbmtub3duIHVuaXQgJyAmIHBlcmlvZC51bml0KQogIGVuZAoKLyoKICBSZXR1cm5zIGEgZGFpbHkgZnJlcXVlbmN5IGZvciB0aGUgZ2l2ZW4gY29kZSByZXByZXNlbnRhdGlvbiBvZiBmcmVxdWVuY3kuCiAgVGhlIGZ1bmN0aW9uIGV4cGVjdHMgY29kZXMgZnJvbSB0aGUgW0V2ZW50VGltaW5nXShodHRwOi8vaGw3Lm9yZy9maGlyL2NvZGVzeXN0ZW0tZXZlbnQtdGltaW5nLmh0bWwpIG9yCiAgW1YzVGltaW5nRXZlbnRdKGh0dHA6Ly9obDcub3JnL2ZoaXIvdjMvVGltaW5nRXZlbnQvY3MuaHRtbCkgY29kZSBzeXN0ZW1zLgogIC8vIFRPRE86IERldGVybWluZSB3aGV0aGVyIG9yIG5vdCB3ZSBzaG91bGQgdXNlIHRpbWluZy5jb2RlIGF0IGFsbC4uLi4KKi8KZGVmaW5lIGZ1bmN0aW9uIFRvRGFpbHkoZnJlcXVlbmN5IENvZGUpOgogIGNhc2UKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkhTIiB0aGVuIDEgLy8gZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSB0aGUgaG91ciBvZiBzbGVlcCAob3IgdHJ5aW5nIHRvKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiV0FLRSIgdGhlbiAxIC8vIGV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciB3YWtpbmcKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkMiIHRoZW4gMyAvLwlldmVudCBvY2N1cnMgYXQgYSBtZWFsIChmcm9tIHRoZSBMYXRpbiBjaWJ1cykKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkNNIiB0aGVuIDEgLy8JZXZlbnQgb2NjdXJzIGF0IGJyZWFrZmFzdCAoZnJvbSB0aGUgTGF0aW4gY2lidXMgbWF0dXRpbnVzKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiQ0QiIHRoZW4gMSAvLwlldmVudCBvY2N1cnMgYXQgbHVuY2ggKGZyb20gdGhlIExhdGluIGNpYnVzIGRpdXJudXMpCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJDViIgdGhlbiAxIC8vCWV2ZW50IG9jY3VycyBhdCBkaW5uZXIgKGZyb20gdGhlIExhdGluIGFudGUgY2lidXMgdmVzcGVydGludXMpCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJBQyIgdGhlbiAzIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBiZWZvcmUgYSBtZWFsIChmcm9tIHRoZSBMYXRpbiBhbnRlIGNpYnVzKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiQUNNIiB0aGVuIDEgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSBicmVha2Zhc3QgKGZyb20gdGhlIExhdGluIGFudGUgY2lidXMgbWF0dXRpbnVzKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiQUNEIiB0aGVuIDEgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSBsdW5jaCAoZnJvbSB0aGUgTGF0aW4gYW50ZSBjaWJ1cyBkaXVybnVzKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiQUNWIiB0aGVuIDEgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGJlZm9yZSBkaW5uZXIgKGZyb20gdGhlIExhdGluIGFudGUgY2lidXMgdmVzcGVydGludXMpCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJQQyIgdGhlbiAzIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBhIG1lYWwgKGZyb20gdGhlIExhdGluIHBvc3QgY2lidXMpCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJQQ00iIHRoZW4gMSAvLwlldmVudCBvY2N1cnMgW29mZnNldF0gYWZ0ZXIgYnJlYWtmYXN0IChmcm9tIHRoZSBMYXRpbiBwb3N0IGNpYnVzIG1hdHV0aW51cykKICAgIHdoZW4gZnJlcXVlbmN5IH4gIlBDRCIgdGhlbiAxIC8vCWV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBsdW5jaCAoZnJvbSB0aGUgTGF0aW4gcG9zdCBjaWJ1cyBkaXVybnVzKQogICAgd2hlbiBmcmVxdWVuY3kgfiAiUENWIiB0aGVuIDEgLy8JZXZlbnQgb2NjdXJzIFtvZmZzZXRdIGFmdGVyIGRpbm5lciAoZnJvbSB0aGUgTGF0aW4gcG9zdCBjaWJ1cyB2ZXNwZXJ0aW51cykKCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJNT1JOIiB0aGVuIDEgLy8JRXZlbnQgb2NjdXJzIGR1cmluZyB0aGUgbW9ybmluZy4gVGhlIGV4YWN0IHRpbWUgaXMgdW5zcGVjaWZpZWQgYW5kIGVzdGFibGlzaGVkIGJ5IGluc3RpdHV0aW9uIGNvbnZlbnRpb24gb3IgcGF0aWVudCBpbnRlcnByZXRhdGlvbi4KICAgIHdoZW4gZnJlcXVlbmN5IH4gIk1PUk4uZWFybHkiIHRoZW4gMSAvLwlFYXJseSBNb3JuaW5nCUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIGVhcmx5IG1vcm5pbmcuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJNT1JOLmxhdGUiIHRoZW4gMSAvLyBMYXRlIE1vcm5pbmcJRXZlbnQgb2NjdXJzIGR1cmluZyB0aGUgbGF0ZSBtb3JuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiTk9PTiIgdGhlbiAxIC8vCU5vb24JRXZlbnQgb2NjdXJzIGFyb3VuZCAxMjowMHBtLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiQUZUIiB0aGVuIDEgLy8JQWZ0ZXJub29uCUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIGFmdGVybm9vbi4gVGhlIGV4YWN0IHRpbWUgaXMgdW5zcGVjaWZpZWQgYW5kIGVzdGFibGlzaGVkIGJ5IGluc3RpdHV0aW9uIGNvbnZlbnRpb24gb3IgcGF0aWVudCBpbnRlcnByZXRhdGlvbi4KICAgIHdoZW4gZnJlcXVlbmN5IH4gIkFGVC5lYXJseSIgdGhlbiAxIC8vCUVhcmx5IEFmdGVybm9vbglFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBlYXJseSBhZnRlcm5vb24uIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJBRlQubGF0ZSIgdGhlbiAxIC8vCUxhdGUgQWZ0ZXJub29uCUV2ZW50IG9jY3VycyBkdXJpbmcgdGhlIGxhdGUgYWZ0ZXJub29uLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiRVZFIiB0aGVuIDEgLy8JRXZlbmluZwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBldmVuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiRVZFLmVhcmx5IiB0aGVuIDEgLy8JRWFybHkgRXZlbmluZwlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBlYXJseSBldmVuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiRVZFLmxhdGUiIHRoZW4gMSAvLwlMYXRlIEV2ZW5pbmcJRXZlbnQgb2NjdXJzIGR1cmluZyB0aGUgbGF0ZSBldmVuaW5nLiBUaGUgZXhhY3QgdGltZSBpcyB1bnNwZWNpZmllZCBhbmQgZXN0YWJsaXNoZWQgYnkgaW5zdGl0dXRpb24gY29udmVudGlvbiBvciBwYXRpZW50IGludGVycHJldGF0aW9uLgogICAgd2hlbiBmcmVxdWVuY3kgfiAiTklHSFQiIHRoZW4gMSAvLwlOaWdodAlFdmVudCBvY2N1cnMgZHVyaW5nIHRoZSBuaWdodC4gVGhlIGV4YWN0IHRpbWUgaXMgdW5zcGVjaWZpZWQgYW5kIGVzdGFibGlzaGVkIGJ5IGluc3RpdHV0aW9uIGNvbnZlbnRpb24gb3IgcGF0aWVudCBpbnRlcnByZXRhdGlvbi4KICAgIHdoZW4gZnJlcXVlbmN5IH4gIlBIUyIgdGhlbiAxIC8vCUFmdGVyIFNsZWVwCUV2ZW50IG9jY3VycyBbb2Zmc2V0XSBhZnRlciBzdWJqZWN0IGdvZXMgdG8gc2xlZXAuIFRoZSBleGFjdCB0aW1lIGlzIHVuc3BlY2lmaWVkIGFuZCBlc3RhYmxpc2hlZCBieSBpbnN0aXR1dGlvbiBjb252ZW50aW9uIG9yIHBhdGllbnQgaW50ZXJwcmV0YXRpb24uCgogICAgd2hlbiBmcmVxdWVuY3kgfiAiT25jZSBkYWlseSAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiAxLjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIlR3aWNlIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDIuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiVGhyZWUgdGltZXMgZGFpbHkgKHF1YWxpZmllciB2YWx1ZSkiIHRoZW4gMy4wCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJGb3VyIHRpbWVzIGRhaWx5IChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDQuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiRXZlcnkgdHdlbnR5IGZvdXIgaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiIHRoZW4gMS4wCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJFdmVyeSB0d2VsdmUgaG91cnMgKHF1YWxpZmllciB2YWx1ZSkiIHRoZW4gMi4wCiAgICB3aGVuIGZyZXF1ZW5jeSB+ICJFdmVyeSB0aGlydHkgc2l4IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDAuNjcKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IGVpZ2h0IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDMuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiRXZlcnkgZm91ciBob3VycyAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiA2LjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IHNpeCBob3VycyAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiA0LjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IHNldmVudHkgdHdvIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDAuMzMKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IGZvcnR5IGVpZ2h0IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDAuNQogICAgd2hlbiBmcmVxdWVuY3kgfiAiRXZlcnkgZWlnaHQgdG8gdHdlbHZlIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDMuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiRXZlcnkgc2l4IHRvIGVpZ2h0IGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDQuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiRXZlcnkgdGhyZWUgdG8gZm91ciBob3VycyAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiA4LjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IHRocmVlIHRvIHNpeCBob3VycyAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiA4LjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIkV2ZXJ5IHR3byB0byBmb3VyIGhvdXJzIChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDEyLjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIk9uZSB0byBmb3VyIHRpbWVzIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDQuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiT25lIHRvIHRocmVlIHRpbWVzIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDMuMAogICAgd2hlbiBmcmVxdWVuY3kgfiAiT25lIHRvIHR3byB0aW1lcyBhIGRheSAocXVhbGlmaWVyIHZhbHVlKSIgdGhlbiAyLjAKICAgIHdoZW4gZnJlcXVlbmN5IH4gIlR3byB0byBmb3VyIHRpbWVzIGEgZGF5IChxdWFsaWZpZXIgdmFsdWUpIiB0aGVuIDQuMAoKICAgIGVsc2UgTWVzc2FnZShudWxsLCB0cnVlLCAnQ01ETG9naWMuVG9EYWlseS5Vbmtub3duRnJlcXVlbmN5Q29kZScsIEVycm9yTGV2ZWwsICdVbmtub3duIGZyZXF1ZW5jeSBjb2RlICcgJiBmcmVxdWVuY3kuY29kZSkKICBlbmQKCi8qCk5vdyB0aGF0IHdlIGhhdmUgYSBUb0RhaWx5IGZ1bmN0aW9uLCB3ZSBjYW4gYXBwcm9hY2ggY2FsY3VsYXRpb24gb2YgdGhlCmR1cmF0aW9uIG9mIG1lZGljYXRpb24gZm9yIGFuIG9yZGVyLiBGaXJzdCwgY29uc2lkZXIgdGhlIGRlZmluaXRpb25zCmZvciBlYWNoIGVsZW1lbnQ6CiogMSBhbmQgb25seSAxIGRvc2FnZUluc3RydWN0aW9uCiogMSBhbmQgb25seSAxIGRvc2VBbmRSYXRlCiogMSB0aW1pbmcgd2l0aCAxIHJlcGVhdAoqIGZyZXF1ZW5jeSwgZnJlcXVlbmN5TWF4LCBkZWZhdWx0aW5nIHRvIDEKKiBwZXJpb2QsIHBlcmlvZFVuaXQsIGRlZmF1bHRpbmcgdG8gMSAnZCcKKiBkb3NlUXVhbnRpdHkgb3IgZG9zZVJhbmdlCiogdGltZU9mRGF5CiogYXV0aG9yZWRPbjogVGhlIGRhdGUgdGhlIHByZXNjcmlwdGlvbiB3YXMgd3JpdHRlbgoqIGRpc3BlbnNlUmVxdWVzdC52YWxpZGl0eVBlcmlvZDogVGltZSBwZXJpb2Qgc3VwcGx5IGlzIGF1dGhvcml6ZWQgZm9yCiogZGlzcGVuc2VSZXF1ZXN0LnF1YW50aXR5OiBhbW91bnQgb2YgbWVkaWNhdGlvbiBzdXBwbGllZCBwZXIgZGlzcGVuc2UKKiBkaXNwZW5zZVJlcXVlc3QubnVtYmVyT2ZSZXBlYXRzQWxsb3dlZDogbnVtYmVyIG9mIHJlZmlsbHMgYXV0aG9yaXplZAoqIGRpc3BlbnNlUmVxdWVzdC5leHBlY3RlZFN1cHBseUR1cmF0aW9uOiBudW1iZXIgb2YgZGF5cyBzdXBwbHkgcGVyIGRpc3BlbnNlCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5ib3VuZHNEdXJhdGlvbjogdG90YWwgZHVyYXRpb24gb2YgdGhlIHJlcGVhdAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQuYm91bmRzUmFuZ2U6IHJhbmdlIG9mIGR1cmF0aW9ucyBvZiB0aGUgcmVwZWF0CiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5ib3VuZHNQZXJpb2Q6IHBlcmlvZCBib3VuZHMgb2YgdGhlIHJlcGVhdAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQuY291bnQ6IG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LmNvdW50TWF4OiBtYXhpbXVtIG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LmZyZXF1ZW5jeTogZXZlbnQgb2NjdXJzIGZyZXF1ZW5jeSB0aW1lcyBwZXIgcGVyaW9kCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5mcmVxdWVuY3lNYXg6IGV2ZW50IG9jY3VycyB1cCB0byBmcmVxdWVuY3lNYXggdGltZXMgcGVyIHBlcmlvZAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQucGVyaW9kOiBldmVudCBvY2N1cnMgZnJlcXVlbmN5IHRpbWVzIHBlciBwZXJpb2QKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LnBlcmlvZE1heDogdXBwZXIgbGltaXQgb2YgcGVyaW9kCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5wZXJpb2RVbml0OiBwZXJpb2QgZHVyYXRpb24gKHMgfCBtaW4gfCBoIHwgZCB8IHdrIHwgbW8gfCBhKQoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQudGltZU9mRGF5OiB0aW1lIG9mIGRheSBmb3IgdGhlIGV2ZW50ICgwLi4qKQoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQud2hlbjogZXZlbnQgdGltaW5nIChIUyB8IFdBS0UgfCBDIHwgQ00gfCBDRCB8IENWIHwgQUMgfCBBQ00uLi4pCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLmNvZGU6IEJJRCB8IFRJRCB8IFFJRCB8IEFNIHwgUE0gfCBRRCB8IFFPRC4uLgoqIGRvc2FnZUluc3RydWN0aW9uLmFzTmVlZGVkCiogZG9zYWdlSW5zdHJ1Y3Rpb24uZG9zZUFuZFJhdGUuZG9zZVF1YW50aXR5CiogZG9zYWdlSW5zdHJ1Y3Rpb24uZG9zZUFuZFJhdGUuZG9zZVJhbmdlCklmIGV4cGVjdGVkU3VwcGx5RHVyYXRpb24gaXMgcHJlc2VudCwgdGhlbiB0aGUgZHVyYXRpb24gaXMKICAgIGV4cGVjdGVkU3VwcGx5RHVyYXRpb24gKiAoMSArIG51bWJlck9mUmVwZWF0c0FsbG93ZWQpCklmIGV4cGVjdGVkU3VwcGx5RHVyYXRpb24gaXMgbm90IHByZXNlbnQsIHRoZW4gaXQgbXVzdCBiZSBjYWxjdWxhdGVkIGJhc2VkIG9uIHRoZSBxdWFudGl0eSwgZG9zYWdlLCBhbmQgZnJlcXVlbmN5OgogICAgKHF1YW50aXR5IC8gKGRvc2FnZSAqIGZyZXF1ZW5jeSkpICogKDEgKyBudW1iZXJPZlJlcGVhdHNBbGxvd2VkKQogICAgZG9zYWdlOiBDb2FsZXNjZShlbmQgb2YgZG9zZUFuZFJhdGUuZG9zZVJhbmdlLCBkb3NlQW5kUmF0ZS5kb3NlUXVhbnRpdHkpCiAgICBmcmVxdWVuY3k6IENvYWxlc2NlKGZyZXF1ZW5jeU1heCwgZnJlcXVlbmN5KQogICAgcGVyaW9kOiBRdWFudGl0eShwZXJpb2QsIHBlcmlvZFVuaXQpCklmIGV4cGVjdGVkU3VwcGx5RHVyYXRpb24gaXMgbm90IHByZXNlbnQgYW5kIGNhbm5vdCBiZSBjYWxjdWxhdGVkLCBhbmQgdGhlIGJvdW5kc1BlcmlvZCBpcyBwcmVzZW50IChhbmQgY29tcGxldGVseSBzcGVjaWZpZWQpLCB3ZSBjYW4gdXNlIHRoYXQgZGlyZWN0bHkKICAgIGRvc2FnZS50aW1pbmcucmVwZWF0LmJvdW5kc1BlcmlvZApUaGlzIGNhbGN1bGF0aW9uIHJlc3VsdHMgaW4gYSBudW1iZXIgb2YgZGF5cywgd2hpY2ggY2FuIHRoZW4gYmUgdHVybmVkIGludG8gYSBwZXJpb2QgYnkgYW5jaG9yaW5nIHRoYXQgdG8gdGhlCnN0YXJ0IG9mIHRoZSB2YWxpZGl0eVBlcmlvZCBvciB0aGUgYXV0aG9yZWRPbjoKICAgIEludGVydmFsW2VhcmxpZXN0RGlzcGVuc2FibGUsIGVhcmxpZXN0RGlzcGVuc2FibGUgKyBleHBlY3RlZFN1cHBseUR1cmF0aW9uIC0gMV0KICAgIGVhcmxpZXN0RGlzcGVuc2FibGU6IENvYWxlc2NlKHN0YXJ0IG9mIHZhbGlkaXR5UGVyaW9kLCBhdXRob3JlZE9uKQpUaGUgZm9sbG93aW5nIGZ1bmN0aW9uIGlsbHVzdHJhdGVzIHRoaXMgY29tcGxldGVseToKKi8KCi8qCkNhbGN1bGF0ZXMgdGhlIE1lZGljYXRpb24gUGVyaW9kIGZvciBhIHNpbmdsZSBNZWRpY2F0aW9uUmVxdWVzdC4KTWVkaWNhdGlvblJlcXVlc3QgaW5zdGFuY2VzIHByb3ZpZGVkIHRvIHRoaXMgZnVuY3Rpb24gYXJlIGV4cGVjdGVkCnRvIGNvbmZvcm0gdG8gdGhlIFtNTUVNZWRpY2F0aW9uUmVxdWVzdF0oaHR0cDovL2J1aWxkLmZoaXIub3JnL2lnL2NxZnJhbWV3b3JrL29waW9pZC1tbWUtcjQvU3RydWN0dXJlRGVmaW5pdGlvbi1tbWVtZWRpY2F0aW9ucmVxdWVzdC5odG1sKQpwcm9maWxlLCB3aGljaCBleHBlY3RzOgoqIDEgYW5kIG9ubHkgMSBkb3NhZ2VJbnN0cnVjdGlvbiwgbXVsdGlwbGUgZG9zYWdlSW5zdHJ1Y3Rpb24gZWxlbWVudHMgd2lsbCByZXN1bHQgaW4gYW4gZXJyb3IKKiAxIGFuZCBvbmx5IDEgZG9zZUFuZFJhdGUsIG11bHRpcGxlIGRvc2VBbmRSYXRlIGVsZW1lbnRzIHdpbGwgcmVzdWx0IGluIGFuIGVycm9yCiogMSB0aW1pbmcgd2l0aCAxIHJlcGVhdCwgbWlzc2luZyB0aW1pbmcgb3IgcmVwZWF0IGVsZW1lbnRzIHdpbGwgcmVzdWx0IGluIGEgbnVsbAoqIGZyZXF1ZW5jeSwgZnJlcXVlbmN5TWF4LCBkZWZhdWx0aW5nIHRvIDEKKiBwZXJpb2QsIHBlcmlvZFVuaXQsIGRlZmF1bHRpbmcgdG8gMSAnZCcKKiB0aW1lT2ZEYXkKKiBkb3NlUXVhbnRpdHkgb3IgZG9zZVJhbmdlLCBtaXNzaW5nIGRvc2VRdWFudGl0eSBhbmQgZG9zZVJhbmdlIHdpbGwgcmVzdWx0IGluIGEgbnVsbApOb3RlIHRoYXQgTWVkaWNhdGlvblJlcXVlc3Qgc3RhdHVzIGlzIG5vdCBjb25zaWRlcmVkIGJ5IHRoaXMgY2FsY3VsYXRpb24sIGFzIHRoZQpsaXN0IG9mIE1lZGljYXRpb25SZXF1ZXN0IGluc3RhbmNlcyBwcm92aWRlZCB0byB0aGlzIGZ1bmN0aW9uIHNob3VsZCBhbHJlYWR5IGhhdmUKY29uc2lkZXJlZCBhcHByb3ByaWF0ZSBzdGF0dXNlcywgZGVwZW5kaW5nIG9uIHRoZSB1c2UgY2FzZSwgdHlwaWNhbGx5IGBjb21wbGV0ZWRgLgoqLwpkZWZpbmUgZnVuY3Rpb24gTWVkaWNhdGlvblJlcXVlc3RQZXJpb2QoUmVxdWVzdCAiTWVkaWNhdGlvblJlcXVlc3QiKToKICBSZXF1ZXN0IFIKICAgIGxldAogICAgICBkb3NhZ2U6IHNpbmdsZXRvbiBmcm9tIFIuZG9zYWdlSW5zdHJ1Y3Rpb24sCiAgICAgIGRvc2VBbmRSYXRlOiBzaW5nbGV0b24gZnJvbSBkb3NhZ2UuZG9zZUFuZFJhdGUsCiAgICAgIHRpbWluZzogZG9zYWdlLnRpbWluZywKICAgICAgZnJlcXVlbmN5OiBDb2FsZXNjZSh0aW1pbmcucmVwZWF0LmZyZXF1ZW5jeU1heCwgdGltaW5nLnJlcGVhdC5mcmVxdWVuY3kpLAogICAgICBwZXJpb2Q6IFF1YW50aXR5KHRpbWluZy5yZXBlYXQucGVyaW9kLCB0aW1pbmcucmVwZWF0LnBlcmlvZFVuaXQpLAogICAgICBkb3NlUmFuZ2U6IGRvc2VBbmRSYXRlLmRvc2UsCiAgICAgIGRvc2VRdWFudGl0eTogZG9zZUFuZFJhdGUuZG9zZSwKICAgICAgZG9zZTogQ29hbGVzY2UoZW5kIG9mIGRvc2VSYW5nZSwgZG9zZVF1YW50aXR5KSwKICAgICAgZG9zZXNQZXJEYXk6IENvYWxlc2NlKFRvRGFpbHkoZnJlcXVlbmN5LCBwZXJpb2QpLCBDb3VudCh0aW1pbmcucmVwZWF0LnRpbWVPZkRheSksIDEuMCksCiAgICAgIGJvdW5kc1BlcmlvZDogdGltaW5nLnJlcGVhdC5ib3VuZHMgYXMgSW50ZXJ2YWw8RGF0ZVRpbWU+LAogICAgICBkYXlzU3VwcGx5OiAoUi5kaXNwZW5zZVJlcXVlc3QuZXhwZWN0ZWRTdXBwbHlEdXJhdGlvbikudmFsdWUsCiAgICAgIHF1YW50aXR5OiBSLmRpc3BlbnNlUmVxdWVzdC5xdWFudGl0eSwKICAgICAgcmVmaWxsczogQ29hbGVzY2UoUi5kaXNwZW5zZVJlcXVlc3QubnVtYmVyT2ZSZXBlYXRzQWxsb3dlZCwgMCksCiAgICAgIHN0YXJ0RGF0ZToKICAgICAgICBDb2FsZXNjZSgKICAgICAgICAgIGRhdGUgZnJvbSBzdGFydCBvZiBib3VuZHNQZXJpb2QsCiAgICAgICAgICBkYXRlIGZyb20gUi5hdXRob3JlZE9uLAogICAgICAgICAgZGF0ZSBmcm9tIHN0YXJ0IG9mIFIuZGlzcGVuc2VSZXF1ZXN0LnZhbGlkaXR5UGVyaW9kCiAgICAgICAgKSwKICAgICAgdG90YWxEYXlzU3VwcGxpZWQ6IENvYWxlc2NlKGRheXNTdXBwbHksIHF1YW50aXR5LnZhbHVlIC8gKGRvc2UudmFsdWUgKiBkb3Nlc1BlckRheSkpICogKDEgKyByZWZpbGxzKQogICAgcmV0dXJuCiAgICAgIGlmIHN0YXJ0RGF0ZSBpcyBub3QgbnVsbCBhbmQgdG90YWxEYXlzU3VwcGxpZWQgaXMgbm90IG51bGwgdGhlbgogICAgICAgIEludGVydmFsW3N0YXJ0RGF0ZSwgc3RhcnREYXRlICsgUXVhbnRpdHkodG90YWxEYXlzU3VwcGxpZWQgLSAxLCAnZGF5JykgXQogICAgICBlbHNlIGlmIHN0YXJ0RGF0ZSBpcyBub3QgbnVsbCBhbmQgYm91bmRzUGVyaW9kLiJoaWdoIiBpcyBub3QgbnVsbCB0aGVuCiAgICAgICAgSW50ZXJ2YWxbc3RhcnREYXRlLCBkYXRlIGZyb20gZW5kIG9mIGJvdW5kc1BlcmlvZF0KICAgICAgZWxzZQogICAgICAgIG51bGwKCiBkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG1lZGljYXRpb25SZXF1ZXN0UGVyaW9kKFJlcXVlc3QgIk1lZGljYXRpb25SZXF1ZXN0Iik6CiAgUmVxdWVzdCBSCiAgICBsZXQKICAgICAgZG9zYWdlOiBzaW5nbGV0b24gZnJvbSBSLmRvc2FnZUluc3RydWN0aW9uLAogICAgICBkb3NlQW5kUmF0ZTogc2luZ2xldG9uIGZyb20gZG9zYWdlLmRvc2VBbmRSYXRlLAogICAgICB0aW1pbmc6IGRvc2FnZS50aW1pbmcsCiAgICAgIGZyZXF1ZW5jeTogQ29hbGVzY2UodGltaW5nLnJlcGVhdC5mcmVxdWVuY3lNYXgsIHRpbWluZy5yZXBlYXQuZnJlcXVlbmN5KSwKICAgICAgcGVyaW9kOiBRdWFudGl0eSh0aW1pbmcucmVwZWF0LnBlcmlvZCwgdGltaW5nLnJlcGVhdC5wZXJpb2RVbml0KSwKICAgICAgZG9zZVJhbmdlOiBkb3NlQW5kUmF0ZS5kb3NlLAogICAgICBkb3NlUXVhbnRpdHk6IGRvc2VBbmRSYXRlLmRvc2UsCiAgICAgIGRvc2U6IENvYWxlc2NlKGVuZCBvZiBkb3NlUmFuZ2UsIGRvc2VRdWFudGl0eSksCiAgICAgIGRvc2VzUGVyRGF5OiBDb2FsZXNjZShUb0RhaWx5KGZyZXF1ZW5jeSwgcGVyaW9kKSwgQ291bnQodGltaW5nLnJlcGVhdC50aW1lT2ZEYXkpLCAxLjApLAogICAgICBib3VuZHNQZXJpb2Q6IHRpbWluZy5yZXBlYXQuYm91bmRzIGFzIEludGVydmFsPERhdGVUaW1lPiwKICAgICAgZGF5c1N1cHBseTogKFIuZGlzcGVuc2VSZXF1ZXN0LmV4cGVjdGVkU3VwcGx5RHVyYXRpb24pLnZhbHVlLAogICAgICBxdWFudGl0eTogUi5kaXNwZW5zZVJlcXVlc3QucXVhbnRpdHksCiAgICAgIHJlZmlsbHM6IENvYWxlc2NlKFIuZGlzcGVuc2VSZXF1ZXN0Lm51bWJlck9mUmVwZWF0c0FsbG93ZWQsIDApLAogICAgICBzdGFydERhdGU6CiAgICAgICAgQ29hbGVzY2UoCiAgICAgICAgICBkYXRlIGZyb20gc3RhcnQgb2YgYm91bmRzUGVyaW9kLAogICAgICAgICAgZGF0ZSBmcm9tIFIuYXV0aG9yZWRPbiwKICAgICAgICAgIGRhdGUgZnJvbSBzdGFydCBvZiBSLmRpc3BlbnNlUmVxdWVzdC52YWxpZGl0eVBlcmlvZAogICAgICAgICksCiAgICAgIHRvdGFsRGF5c1N1cHBsaWVkOiBDb2FsZXNjZShkYXlzU3VwcGx5LCBxdWFudGl0eS52YWx1ZSAvIChkb3NlLnZhbHVlICogZG9zZXNQZXJEYXkpKSAqICgxICsgcmVmaWxscykKICAgIHJldHVybgogICAgICBpZiBzdGFydERhdGUgaXMgbm90IG51bGwgYW5kIHRvdGFsRGF5c1N1cHBsaWVkIGlzIG5vdCBudWxsIHRoZW4KICAgICAgICBJbnRlcnZhbFtzdGFydERhdGUsIHN0YXJ0RGF0ZSArIFF1YW50aXR5KHRvdGFsRGF5c1N1cHBsaWVkIC0gMSwgJ2RheScpIF0KICAgICAgZWxzZSBpZiBzdGFydERhdGUgaXMgbm90IG51bGwgYW5kIGJvdW5kc1BlcmlvZC4iaGlnaCIgaXMgbm90IG51bGwgdGhlbgogICAgICAgIEludGVydmFsW3N0YXJ0RGF0ZSwgZGF0ZSBmcm9tIGVuZCBvZiBib3VuZHNQZXJpb2RdCiAgICAgIGVsc2UKICAgICAgICBudWxsCgovKgpOZXh0LCBjb25zaWRlciB0aGUgTWVkaWNhdGlvbkRpc3BlbnNlIGNhc2U6Ciogd2hlblByZXBhcmVkOiBXaGVuIHByb2R1Y3Qgd2FzIHByZXBhcmVkCiogd2hlbkhhbmRlZE92ZXI6IFdoZW4gcHJvZHVjdCB3YXMgZ2l2ZW4gb3V0CiogcXVhbnRpdHk6IEFtb3VudCBkaXNwZW5zZWQKKiBkYXlzU3VwcGx5OiBBbW91bnQgb2YgbWVkaWNhdGlvbiBleHByZXNzZWQgYXMgYSB0aW1pbmcgYW1vdW50CiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5ib3VuZHNEdXJhdGlvbjogdG90YWwgZHVyYXRpb24gb2YgdGhlIHJlcGVhdAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQuYm91bmRzUmFuZ2U6IHJhbmdlIG9mIGR1cmF0aW9ucyBvZiB0aGUgcmVwZWF0CiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5ib3VuZHNQZXJpb2Q6IHBlcmlvZCBib3VuZHMgb2YgdGhlIHJlcGVhdAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQuY291bnQ6IG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LmNvdW50TWF4OiBtYXhpbXVtIG51bWJlciBvZiB0aW1lcyB0byByZXBlYXQKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LmZyZXF1ZW5jeTogZXZlbnQgb2NjdXJzIGZyZXF1ZW5jeSB0aW1lcyBwZXIgcGVyaW9kCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5mcmVxdWVuY3lNYXg6IGV2ZW50IG9jY3VycyB1cCB0byBmcmVxdWVuY3lNYXggdGltZXMgcGVyIHBlcmlvZAoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQucGVyaW9kOiBldmVudCBvY2N1cnMgZnJlcXVlbmN5IHRpbWVzIHBlciBwZXJpb2QKKiBkb3NhZ2VJbnN0cnVjdGlvbi50aW1pbmcucmVwZWF0LnBlcmlvZE1heDogdXBwZXIgbGltaXQgb2YgcGVyaW9kCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLnJlcGVhdC5wZXJpb2RVbml0OiBwZXJpb2QgZHVyYXRpb24gKHMgfCBtaW4gfCBoIHwgZCB8IHdrIHwgbW8gfCBhKQoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQudGltZU9mRGF5OiB0aW1lIG9mIGRheSBmb3IgdGhlIGV2ZW50ICgwLi4qKQoqIGRvc2FnZUluc3RydWN0aW9uLnRpbWluZy5yZXBlYXQud2hlbjogZXZlbnQgdGltaW5nIChIUyB8IFdBS0UgfCBDIHwgQ00gfCBDRCB8IENWIHwgQUMgfCBBQ00uLi4pCiogZG9zYWdlSW5zdHJ1Y3Rpb24udGltaW5nLmNvZGU6IEJJRCB8IFRJRCB8IFFJRCB8IEFNIHwgUE0gfCBRRCB8IFFPRC4uLgoqIGRvc2FnZUluc3RydWN0aW9uLmFzTmVlZGVkCiogZG9zYWdlSW5zdHJ1Y3Rpb24uZG9zZUFuZFJhdGUuZG9zZVF1YW50aXR5CiogZG9zYWdlSW5zdHJ1Y3Rpb24uZG9zZUFuZFJhdGUuZG9zZVJhbmdlCldlIGhhdmUgZWZmZWN0aXZlbHkgdGhlIHNhbWUgZWxlbWVudHMsIHdpdGggdGhlIHNhbWUgbWVhbmluZ3MsIHdpdGggdGhlIGV4Y2VwdGlvbiB0aGF0IHRoZQpldmVudCBpcyBkb2N1bWVudGluZyBhIHNpbmdsZSBkaXNwZW5zZSwgYW5kIGRvZXMgbm90IGNvbnRhaW4gcmVmaWxsIGluZm9ybWF0aW9uLiBJbiBhZGRpdGlvbiwKbXVsdGlwbGUgZGlzcGVuc2UgZXZlbnRzIHdvdWxkIHR5cGljYWxseSBiZSBwcmVzZW50LCBhbmQgdGhvc2Ugd291bGQgYWxsIGhhdmUgdG8gYmUgY29uc2lkZXJlZAphcyBwYXJ0IG9mIGFuIG92ZXJhbGwgY2FsY3VsYXRpb24uIFRoYXQgd2lsbCBiZSBjb25zaWRlcmVkIHdoZW4gd2UgY29tYmluZSByZXN1bHRzLCBidXQgZm9yCnRoaXMgZnVuY3Rpb24sIHdlJ2xsIGZvY3VzIG9uIGNhbGN1bGF0aW5nIHRoZSBkdXJhdGlvbiBvZiBhIHNpbmdsZSBkaXNwZW5zZS4KV2l0aCBhIE1lZGljYXRpb25EaXNwZW5zZSwgZG9zYWdlIGluZm9ybWF0aW9uIGlzIGV4cGVjdGVkIHRvIGJlIHRoZSBzYW1lIGFzIHRoZSByZWxhdGVkCk1lZGljYXRpb25SZXF1ZXN0LCBzbyBib3VuZHNQZXJpb2Qgd291bGQgc3RpbGwgY292ZXIgdGhlIGVudGlyZSBwcmVzY3JpcHRpb24gKGluY2x1ZGluZyByZWZpbGxzKQphbmQgc28gY2Fubm90IGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBpbnRlcnZhbCBjb3ZlcmVkIGJ5IHRoZSBkaXNwZW5zZS4KSWYgdGhlIGRheXNTdXBwbHkgZWxlbWVudCBpcyBwcmVzZW50LCB0aGVuIHRoZSBkdXJhdGlvbiBpbiBkYXlzIGlzIHNpbXBseQogICAgZGF5c1N1cHBseQpOb3RlIHNwZWNpZmljYWxseSB0aGF0IHdlIGFyZSBub3QgY29uc2lkZXJpbmcgcmVmaWxscywgYXMgdGhvc2Ugd291bGQgYmUgY292ZXJlZApieSBzdWJzZXF1ZW50IGRpc3BlbnNlIHJlY29yZHMuCklmIGRheXNTdXBwbGllZCBpcyBub3QgcHJlc2VudCwgdGhlbiBkYXlzU3VwcGxpZWQgbXVzdCBiZSBjYWxjdWxhdGVkIGJhc2VkIG9uCnRoZSBxdWFudGl0eSwgZG9zYWdlLCBhbmQgZnJlcXVlbmN5OgogICAgKHF1YW50aXR5IC8gKGRvc2FnZSAqIGZyZXF1ZW5jeSkpClRoaXMgY2FsY3VsYXRpb24gcmVzdWx0cyBpbiBhIG51bWJlciBvZiBkYXlzLCB3aGljaCBjYW4gdGhlbiBiZSB0dXJuZWQgaW50byBhCnBlcmlvZCBieSBhbmNob3JpbmcgdGhhdCB0byB0aGUgc3RhcnREYXRlLCBhcyBkZXRlcm1pbmVkIGJ5IHRoZSBmaXJzdCBhdmFpbGFibGUKdmFsdWUgb2YgdGhlIHN0YXJ0IG9mIHRoZSBib3VuZHNQZXJpb2QsIHdoZW5IYW5kZWRPdmVyLCBhbmQgd2hlblByZXBhcmVkLgogICBJbnRlcnZhbFtzdGFydERhdGUsIHN0YXJ0RGF0ZSArIHRvdGFsRGF5c1N1cHBsaWVkIC0gMSBkYXldCiovCgovKgpDYWxjdWxhdGVzIE1lZGljYXRpb24gUGVyaW9kIGZvciBhIGdpdmVuIE1lZGljYXRpb25EaXNwZW5zZQpNZWRpY2F0aW9uRGlzcGVuc2UgaW5zdGFuY2VzIHByb3ZpZGVkIHRvIHRoaXMgZnVuY3Rpb24gYXJlIGV4cGVjdGVkCnRvIGNvbmZvcm0gdG8gdGhlIFtUT0RPOiBNTUVNZWRpY2F0aW9uRGlzcGVuc2VdKGh0dHA6Ly9idWlsZC5maGlyLm9yZy9pZy9jcWZyYW1ld29yay9vcGlvaWQtbW1lLXI0L1N0cnVjdHVyZURlZmluaXRpb24tbW1lbWVkaWNhdGlvbmRpc3BlbnNlLmh0bWwpCnByb2ZpbGUsIHdoaWNoIGV4cGVjdHM6CiogMSBhbmQgb25seSAxIGRvc2FnZUluc3RydWN0aW9uLCBtdWx0aXBsZSBkb3NhZ2VJbnN0cnVjdGlvbiBlbGVtZW50cyB3aWxsIHJlc3VsdCBpbiBhbiBlcnJvcgoqIDEgYW5kIG9ubHkgMSBkb3NlQW5kUmF0ZSwgbXVsdGlwbGUgZG9zZUFuZFJhdGUgZWxlbWVudHMgd2lsbCByZXN1bHQgaW4gYW4gZXJyb3IKKiAxIHRpbWluZyB3aXRoIDEgcmVwZWF0LCBtaXNzaW5nIHRpbWluZyBvciByZXBlYXQgZWxlbWVudHMgd2lsbCByZXN1bHQgaW4gYSBudWxsCiogZnJlcXVlbmN5LCBmcmVxdWVuY3lNYXgsIGRlZmF1bHRpbmcgdG8gMQoqIHBlcmlvZCwgcGVyaW9kVW5pdCwgZGVmYXVsdGluZyB0byAxICdkJwoqIHRpbWVPZkRheQoqIGRvc2VRdWFudGl0eSBvciBkb3NlUmFuZ2UsIG1pc3NpbmcgZG9zZVF1YW50aXR5IGFuZCBkb3NlUmFuZ2Ugd2lsbCByZXN1bHQgaW4gYSBudWxsCiogd2hlbkhhbmRlZE92ZXIgb3Igd2hlblByZXBhcmVkLCBpZiBtaXNzaW5nIGJvdGggd2hlbkhhbmRlZE92ZXIgYW5kIHdoZW5QcmVwYXJlZCB3aWxsIHJlc3VsdCBpbiBhIG51bGwKTm90ZSB0aGF0IE1lZGljYXRpb25EaXNwZW5zZSBzdGF0dXMgaXMgbm90IGNvbnNpZGVyZWQgYnkgdGhpcyBjYWxjdWxhdGlvbiwgYXMgdGhlCmxpc3Qgb2YgTWVkaWNhdGlvbkRpc3BlbnNlIGluc3RhbmNlcyBwcm92aWRlZCB0byB0aGlzIGZ1bmN0aW9uIHNob3VsZCBhbHJlYWR5IGhhdmUKY29uc2lkZXJlZCBhcHByb3ByaWF0ZSBzdGF0dXNlcywgZGVwZW5kaW5nIG9uIHRoZSB1c2UgY2FzZSwgdHlwaWNhbGx5IGBjb21wbGV0ZWRgLAplc3BlY2lhbGx5IHNpbmNlIHdoZW5IYW5kZWRPdmVyIHdvdWxkIGJlIGV4cGVjdGVkIHRvIGJlIHByZXNlbnQgZm9yIGEgY29tcGxldGVkCk1lZGljYXRpb25EaXNwZW5zZS4KTm90ZSBhbHNvIHRoYXQgdGhlIGRvc2FnZSBpbmZvcm1hdGlvbiByZWNvcmRlZCBpbiBhIGRpc3BlbnNlIGlzIGV4cGVjdGVkIHRvIGJlIGEgY29weSBvZiB0aGUKZGlzcGVuc2UgaW5mb3JtYXRpb24gZnJvbSB0aGUgcmVsYXRlZCBtZWRpY2F0aW9uIHJlcXVlc3QuIEFzIHN1Y2gsIHRoZSBib3VuZHNQZXJpb2Qgd291bGQgYmUgZXhwZWN0ZWQKdG8gY292ZXIgdGhlIGVudGlyZSByYW5nZSwgYW5kIHNob3VsZCBfbm90XyBiZSB1c2VkIGZvciB0aW1pbmcgb2YgdGhlIGV2ZW50LgpUaGVyZSBpcyBhbHNvIGFjdGl2ZSBkaXNjdXNzaW9uIGluIHRoZSBQaGFybWFjeSBXRyBhYm91dCB3aGF0IGRhdGUgc2hvdWxkIGJlIHVzZWQgaWYgd2hlblByZXBhcmVkL3doZW5IYW5kZWRPdmVyIGlzIG5vdCBwcmVzZW50LgpUaGlzIG1heSB0YWtlIHRoZSBmb3JtIG9mIGFuICJvcmlnaW5hbCBjcmVhdGlvbiBkYXRlIiwgYnV0IG1heSBhbHNvIGJlIGEgInN0YXR1cyBjaGFuZ2UgZGF0ZSIgZm9yIGRpc3BlbnNlIGV2ZW50cyB0aGF0IGFyZSB1cGRhdGluZwpzdGF0dXMgb2YgYW4gZXhpc3RpbmcgZGlzcGVuc2UuIFRoYXQgZGlzY3Vzc2lvbiBpcyBvbmdvaW5nLCBzbyB1bnRpbCB0aGF0IGlzIHJlc29sdmVkLCB0aGlzIGxvZ2ljIHdpbGwgcmV0dXJuCm51bGwgaWYgd2hlblByZXBhcmVkL3doZW5IYW5kZWRPdmVyIGFyZSBub3QgYXZhaWxhYmxlLgoqLwpkZWZpbmUgZnVuY3Rpb24gTWVkaWNhdGlvbkRpc3BlbnNlUGVyaW9kKERpc3BlbnNlICJNZWRpY2F0aW9uRGlzcGVuc2UiKToKICBEaXNwZW5zZSBECiAgICBsZXQKICAgICAgZG9zYWdlOiBzaW5nbGV0b24gZnJvbSBELmRvc2FnZUluc3RydWN0aW9uLAogICAgICBkb3NlQW5kUmF0ZTogc2luZ2xldG9uIGZyb20gZG9zYWdlLmRvc2VBbmRSYXRlLAogICAgICB0aW1pbmc6IGRvc2FnZS50aW1pbmcsCiAgICAgIGZyZXF1ZW5jeTogQ29hbGVzY2UodGltaW5nLnJlcGVhdC5mcmVxdWVuY3lNYXgsIHRpbWluZy5yZXBlYXQuZnJlcXVlbmN5KSwKICAgICAgcGVyaW9kOiBRdWFudGl0eSh0aW1pbmcucmVwZWF0LnBlcmlvZCwgdGltaW5nLnJlcGVhdC5wZXJpb2RVbml0KSwKICAgICAgZG9zZVJhbmdlOiBkb3NlQW5kUmF0ZS5kb3NlLAogICAgICBkb3NlUXVhbnRpdHk6IGRvc2VBbmRSYXRlLmRvc2UsCiAgICAgIGRvc2U6IENvYWxlc2NlKGVuZCBvZiBkb3NlUmFuZ2UsIGRvc2VRdWFudGl0eSksCiAgICAgIGRheXNTdXBwbHk6IChjb252ZXJ0IEQuZGF5c1N1cHBseSB0byBkYXlzKS52YWx1ZSwKICAgICAgZG9zZXNQZXJEYXk6IENvYWxlc2NlKFRvRGFpbHkoZnJlcXVlbmN5LCBwZXJpb2QpLCBDb3VudCh0aW1pbmcucmVwZWF0LnRpbWVPZkRheSksIDEuMCksCiAgICAgIHN0YXJ0RGF0ZToKICAgICAgICBDb2FsZXNjZSgKICAgICAgICAgIGRhdGUgZnJvbSBELndoZW5IYW5kZWRPdmVyLAogICAgICAgICAgZGF0ZSBmcm9tIEQud2hlblByZXBhcmVkCiAgICAgICAgKSwKICAgICAgdG90YWxEYXlzU3VwcGxpZWQ6IENvYWxlc2NlKGRheXNTdXBwbHksIEQucXVhbnRpdHkudmFsdWUgLyAoZG9zZS52YWx1ZSAqIGRvc2VzUGVyRGF5KSkKICAgIHJldHVybgogICAgICBpZiBzdGFydERhdGUgaXMgbm90IG51bGwgYW5kIHRvdGFsRGF5c1N1cHBsaWVkIGlzIG5vdCBudWxsIHRoZW4KICAgICAgICBJbnRlcnZhbFtzdGFydERhdGUsIHN0YXJ0RGF0ZSArIFF1YW50aXR5KHRvdGFsRGF5c1N1cHBsaWVkIC0gMSwgJ2RheScpXQogICAgICBlbHNlCiAgICAgICAgbnVsbAoKIC8qCkNhbGN1bGF0ZXMgTWVkaWNhdGlvbiBQZXJpb2QgZm9yIGEgZ2l2ZW4gTWVkaWNhdGlvbkRpc3BlbnNlCk1lZGljYXRpb25EaXNwZW5zZSBpbnN0YW5jZXMgcHJvdmlkZWQgdG8gdGhpcyBmdW5jdGlvbiBhcmUgZXhwZWN0ZWQKdG8gY29uZm9ybSB0byB0aGUgW1RPRE86IE1NRU1lZGljYXRpb25EaXNwZW5zZV0oaHR0cDovL2J1aWxkLmZoaXIub3JnL2lnL2NxZnJhbWV3b3JrL29waW9pZC1tbWUtcjQvU3RydWN0dXJlRGVmaW5pdGlvbi1tbWVtZWRpY2F0aW9uZGlzcGVuc2UuaHRtbCkKcHJvZmlsZSwgd2hpY2ggZXhwZWN0czoKKiAxIGFuZCBvbmx5IDEgZG9zYWdlSW5zdHJ1Y3Rpb24sIG11bHRpcGxlIGRvc2FnZUluc3RydWN0aW9uIGVsZW1lbnRzIHdpbGwgcmVzdWx0IGluIGFuIGVycm9yCiogMSBhbmQgb25seSAxIGRvc2VBbmRSYXRlLCBtdWx0aXBsZSBkb3NlQW5kUmF0ZSBlbGVtZW50cyB3aWxsIHJlc3VsdCBpbiBhbiBlcnJvcgoqIDEgdGltaW5nIHdpdGggMSByZXBlYXQsIG1pc3NpbmcgdGltaW5nIG9yIHJlcGVhdCBlbGVtZW50cyB3aWxsIHJlc3VsdCBpbiBhIG51bGwKKiBmcmVxdWVuY3ksIGZyZXF1ZW5jeU1heCwgZGVmYXVsdGluZyB0byAxCiogcGVyaW9kLCBwZXJpb2RVbml0LCBkZWZhdWx0aW5nIHRvIDEgJ2QnCiogdGltZU9mRGF5CiogZG9zZVF1YW50aXR5IG9yIGRvc2VSYW5nZSwgbWlzc2luZyBkb3NlUXVhbnRpdHkgYW5kIGRvc2VSYW5nZSB3aWxsIHJlc3VsdCBpbiBhIG51bGwKKiB3aGVuSGFuZGVkT3ZlciBvciB3aGVuUHJlcGFyZWQsIGlmIG1pc3NpbmcgYm90aCB3aGVuSGFuZGVkT3ZlciBhbmQgd2hlblByZXBhcmVkIHdpbGwgcmVzdWx0IGluIGEgbnVsbApOb3RlIHRoYXQgTWVkaWNhdGlvbkRpc3BlbnNlIHN0YXR1cyBpcyBub3QgY29uc2lkZXJlZCBieSB0aGlzIGNhbGN1bGF0aW9uLCBhcyB0aGUKbGlzdCBvZiBNZWRpY2F0aW9uRGlzcGVuc2UgaW5zdGFuY2VzIHByb3ZpZGVkIHRvIHRoaXMgZnVuY3Rpb24gc2hvdWxkIGFscmVhZHkgaGF2ZQpjb25zaWRlcmVkIGFwcHJvcHJpYXRlIHN0YXR1c2VzLCBkZXBlbmRpbmcgb24gdGhlIHVzZSBjYXNlLCB0eXBpY2FsbHkgYGNvbXBsZXRlZGAsCmVzcGVjaWFsbHkgc2luY2Ugd2hlbkhhbmRlZE92ZXIgd291bGQgYmUgZXhwZWN0ZWQgdG8gYmUgcHJlc2VudCBmb3IgYSBjb21wbGV0ZWQKTWVkaWNhdGlvbkRpc3BlbnNlLgpOb3RlIGFsc28gdGhhdCB0aGUgZG9zYWdlIGluZm9ybWF0aW9uIHJlY29yZGVkIGluIGEgZGlzcGVuc2UgaXMgZXhwZWN0ZWQgdG8gYmUgYSBjb3B5IG9mIHRoZQpkaXNwZW5zZSBpbmZvcm1hdGlvbiBmcm9tIHRoZSByZWxhdGVkIG1lZGljYXRpb24gcmVxdWVzdC4gQXMgc3VjaCwgdGhlIGJvdW5kc1BlcmlvZCB3b3VsZCBiZSBleHBlY3RlZAp0byBjb3ZlciB0aGUgZW50aXJlIHJhbmdlLCBhbmQgc2hvdWxkIF9ub3RfIGJlIHVzZWQgZm9yIHRpbWluZyBvZiB0aGUgZXZlbnQuClRoZXJlIGlzIGFsc28gYWN0aXZlIGRpc2N1c3Npb24gaW4gdGhlIFBoYXJtYWN5IFdHIGFib3V0IHdoYXQgZGF0ZSBzaG91bGQgYmUgdXNlZCBpZiB3aGVuUHJlcGFyZWQvd2hlbkhhbmRlZE92ZXIgaXMgbm90IHByZXNlbnQuClRoaXMgbWF5IHRha2UgdGhlIGZvcm0gb2YgYW4gIm9yaWdpbmFsIGNyZWF0aW9uIGRhdGUiLCBidXQgbWF5IGFsc28gYmUgYSAic3RhdHVzIGNoYW5nZSBkYXRlIiBmb3IgZGlzcGVuc2UgZXZlbnRzIHRoYXQgYXJlIHVwZGF0aW5nCnN0YXR1cyBvZiBhbiBleGlzdGluZyBkaXNwZW5zZS4gVGhhdCBkaXNjdXNzaW9uIGlzIG9uZ29pbmcsIHNvIHVudGlsIHRoYXQgaXMgcmVzb2x2ZWQsIHRoaXMgbG9naWMgd2lsbCByZXR1cm4KbnVsbCBpZiB3aGVuUHJlcGFyZWQvd2hlbkhhbmRlZE92ZXIgYXJlIG5vdCBhdmFpbGFibGUuCiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gbWVkaWNhdGlvbkRpc3BlbnNlUGVyaW9kKERpc3BlbnNlICJNZWRpY2F0aW9uRGlzcGVuc2UiKToKICBEaXNwZW5zZSBECiAgICBsZXQKICAgICAgZG9zYWdlOiBzaW5nbGV0b24gZnJvbSBELmRvc2FnZUluc3RydWN0aW9uLAogICAgICBkb3NlQW5kUmF0ZTogc2luZ2xldG9uIGZyb20gZG9zYWdlLmRvc2VBbmRSYXRlLAogICAgICB0aW1pbmc6IGRvc2FnZS50aW1pbmcsCiAgICAgIGZyZXF1ZW5jeTogQ29hbGVzY2UodGltaW5nLnJlcGVhdC5mcmVxdWVuY3lNYXgsIHRpbWluZy5yZXBlYXQuZnJlcXVlbmN5KSwKICAgICAgcGVyaW9kOiBRdWFudGl0eSh0aW1pbmcucmVwZWF0LnBlcmlvZCwgdGltaW5nLnJlcGVhdC5wZXJpb2RVbml0KSwKICAgICAgZG9zZVJhbmdlOiBkb3NlQW5kUmF0ZS5kb3NlLAogICAgICBkb3NlUXVhbnRpdHk6IGRvc2VBbmRSYXRlLmRvc2UsCiAgICAgIGRvc2U6IENvYWxlc2NlKGVuZCBvZiBkb3NlUmFuZ2UsIGRvc2VRdWFudGl0eSksCiAgICAgIGRheXNTdXBwbHk6IChjb252ZXJ0IEQuZGF5c1N1cHBseSB0byBkYXlzKS52YWx1ZSwKICAgICAgZG9zZXNQZXJEYXk6IENvYWxlc2NlKFRvRGFpbHkoZnJlcXVlbmN5LCBwZXJpb2QpLCBDb3VudCh0aW1pbmcucmVwZWF0LnRpbWVPZkRheSksIDEuMCksCiAgICAgIHN0YXJ0RGF0ZToKICAgICAgICBDb2FsZXNjZSgKICAgICAgICAgIGRhdGUgZnJvbSBELndoZW5IYW5kZWRPdmVyLAogICAgICAgICAgZGF0ZSBmcm9tIEQud2hlblByZXBhcmVkCiAgICAgICAgKSwKICAgICAgdG90YWxEYXlzU3VwcGxpZWQ6IENvYWxlc2NlKGRheXNTdXBwbHksIEQucXVhbnRpdHkudmFsdWUgLyAoZG9zZS52YWx1ZSAqIGRvc2VzUGVyRGF5KSkKICAgIHJldHVybgogICAgICBpZiBzdGFydERhdGUgaXMgbm90IG51bGwgYW5kIHRvdGFsRGF5c1N1cHBsaWVkIGlzIG5vdCBudWxsIHRoZW4KICAgICAgICBJbnRlcnZhbFtzdGFydERhdGUsIHN0YXJ0RGF0ZSArIFF1YW50aXR5KHRvdGFsRGF5c1N1cHBsaWVkIC0gMSwgJ2RheScpXQogICAgICBlbHNlCiAgICAgICAgbnVsbAogCi8qClJldHVybnMgdGhlIGVzdGFibGlzaGVkIHRoZXJhcGV1dGljIGR1cmF0aW9uIGZvciBhIGdpdmVuIG1lZGljYXRpb24uClRoaXMgaXMgbGlrZWx5IG1lYXN1cmUgc3BlY2lmaWMsIHRob3VnaCBjb3VsZCBwb3RlbnRpYWxseSBiZSBlc3RhYmxpc2hlZCBmb3IKYW55IGRydWcgYW5kIGRpc3RyaWJ1dGVkIGFzIGEgQ29kZVN5c3RlbSBzdXBwbGVtZW50LgpEZWZhdWx0aW5nIHRvIDE0IGRheXMgaGVyZSBmb3IgaWxsdXN0cmF0aW9uLgoqLwpkZWZpbmUgZnVuY3Rpb24gVGhlcmFwZXV0aWNEdXJhdGlvbihtZWRpY2F0aW9uIENvbmNlcHQpOgogIDE0IGRheXMKCiAvKgpOZXh0IHdlIGNvbnNpZGVyIE1lZGljYXRpb25BZG1pbmlzdHJhdGlvbi4gVGhpcyBkYXRhIHR5cGUgaXMgdHlwaWNhbGx5IHVzZWQgdG8KY2FwdHVyZSBzcGVjaWZpYyBhZG1pbmlzdHJhdGlvbiwgd2l0aCB0aGUgcmVsZXZhbnRQZXJpb2QgY2FwdHVyaW5nIHN0YXJ0IGFuZCBzdG9wCnRpbWUgb2YgdGhlIGFkbWluaXN0cmF0aW9uIGV2ZW50OgoqIGVmZmVjdGl2ZVt4XTogU3RhcnQgYW5kIGVuZCB0aW1lIG9mIGFkbWluaXN0cmF0aW9uCkhvd2V2ZXIsIHdoZW4gY2FsY3VsYXRpbmcgY3VtdWxhdGl2ZSBtZWRpY2F0aW9uIGR1cmF0aW9uLCBpdCBpcyB0eXBpY2FsbHkgdGhlCnRoZXJhcGV1dGljIHBlcmlvZCBvZiB0aGUgbWVkaWNhdGlvbiB0aGF0IHNob3VsZCBiZSBjb25zaWRlcmVkLiBDdXJyZW50bHkgbmVpdGhlcgp0aGUgTWVkaWNhdGlvbiBub3IgTWVkaWNhdGlvbktub3dsZWRnZSByZXNvdXJjZXMgcHJvdmlkZSB0aGlzIGluZm9ybWF0aW9uLCBzbwp3ZSBtb2RlbCBpdCBoZXJlIGFzIGEgZnVuY3Rpb24gdGhhdCBjYW4gcG90ZW50aWFsbHkgYmUgaW1wbGVtZW50ZWQgaW4gYSB2YXJpZXR5Cm9mIHdheXMsIGluY2x1ZGluZyBtZWFzdXJlLXNwZWNpZmljIHZhbHVlcywgYXMgd2VsbCBhcyBkaXN0cmlidXRpb24gYXMgYW4gUnhOb3JtCmNvZGUgc3lzdGVtIHN1cHBsZW1lbnQuCkhvd2V2ZXIgaXQgaXMgb2J0YWluZWQsIGlmIHRoZXJhcGV1dGljIGR1cmF0aW9uIGNhbiBiZSBvYnRhaW5lZCwgYW5kIHRoZSBlZmZlY3RpdmUKcGVyaW9kIGhhcyBhIHN0YXJ0LCB0aGUgcmVzdWx0IHdpbGwgYmUKICAgIEludGVydmFsW3N0YXJ0RGF0ZSwgc3RhcnREYXRlICsgdGhlcmFwZXV0aWNEdXJhdGlvbiAtIDEgZGF5XQpOT1RFOiBUaGVyYXBldXRpYyBkdXJhdGlvbiBuZWVkcyB0byBiZSBlc3RhYmxpc2hlZCBhbmQgdW50aWwgYSB3YXkgaXMgaW1wbGVtZW50ZWQgdG8KZG8gdGhhdCBiYXNlZCBvbiB0aGUgbWVkaWNhdGlvbiwgdGhpcyBsb2dpYyBpcyBpbmNvbXBsZXRlIGFuZCBzaG91bGQgbm90IGJlIHVzZWQuCiovCmRlZmluZSBmdW5jdGlvbiBNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb25QZXJpb2QoQWRtaW5pc3RyYXRpb24gIk1lZGljYXRpb25BZG1pbmlzdHJhdGlvbiIpOgogIEFkbWluaXN0cmF0aW9uIE0KICAgIGxldAogICAgICB0aGVyYXBldXRpY0R1cmF0aW9uOiBUaGVyYXBldXRpY0R1cmF0aW9uKEFkbWluaXN0cmF0aW9uLm1lZGljYXRpb24pLAogICAgICBzdGFydERhdGU6IGRhdGUgZnJvbSBzdGFydCBvZiBBZG1pbmlzdHJhdGlvbi5lZmZlY3RpdmUKICAgIHJldHVybgogICAgICBpZiBzdGFydERhdGUgaXMgbm90IG51bGwgYW5kIHRoZXJhcGV1dGljRHVyYXRpb24gaXMgbm90IG51bGwgdGhlbgogICAgICAgIEludGVydmFsW3N0YXJ0RGF0ZSwgc3RhcnREYXRlICsgdGhlcmFwZXV0aWNEdXJhdGlvbiAtIDFdCiAgICAgIGVsc2UKICAgICAgICBudWxsCgogLyoKTmV4dCB3ZSBjb25zaWRlciBNZWRpY2F0aW9uQWRtaW5pc3RyYXRpb24uIFRoaXMgZGF0YSB0eXBlIGlzIHR5cGljYWxseSB1c2VkIHRvCmNhcHR1cmUgc3BlY2lmaWMgYWRtaW5pc3RyYXRpb24sIHdpdGggdGhlIHJlbGV2YW50UGVyaW9kIGNhcHR1cmluZyBzdGFydCBhbmQgc3RvcAp0aW1lIG9mIHRoZSBhZG1pbmlzdHJhdGlvbiBldmVudDoKKiBlZmZlY3RpdmVbeF06IFN0YXJ0IGFuZCBlbmQgdGltZSBvZiBhZG1pbmlzdHJhdGlvbgpIb3dldmVyLCB3aGVuIGNhbGN1bGF0aW5nIGN1bXVsYXRpdmUgbWVkaWNhdGlvbiBkdXJhdGlvbiwgaXQgaXMgdHlwaWNhbGx5IHRoZQp0aGVyYXBldXRpYyBwZXJpb2Qgb2YgdGhlIG1lZGljYXRpb24gdGhhdCBzaG91bGQgYmUgY29uc2lkZXJlZC4gQ3VycmVudGx5IG5laXRoZXIKdGhlIE1lZGljYXRpb24gbm9yIE1lZGljYXRpb25Lbm93bGVkZ2UgcmVzb3VyY2VzIHByb3ZpZGUgdGhpcyBpbmZvcm1hdGlvbiwgc28Kd2UgbW9kZWwgaXQgaGVyZSBhcyBhIGZ1bmN0aW9uIHRoYXQgY2FuIHBvdGVudGlhbGx5IGJlIGltcGxlbWVudGVkIGluIGEgdmFyaWV0eQpvZiB3YXlzLCBpbmNsdWRpbmcgbWVhc3VyZS1zcGVjaWZpYyB2YWx1ZXMsIGFzIHdlbGwgYXMgZGlzdHJpYnV0aW9uIGFzIGFuIFJ4Tm9ybQpjb2RlIHN5c3RlbSBzdXBwbGVtZW50LgpIb3dldmVyIGl0IGlzIG9idGFpbmVkLCBpZiB0aGVyYXBldXRpYyBkdXJhdGlvbiBjYW4gYmUgb2J0YWluZWQsIGFuZCB0aGUgZWZmZWN0aXZlCnBlcmlvZCBoYXMgYSBzdGFydCwgdGhlIHJlc3VsdCB3aWxsIGJlCiAgICBJbnRlcnZhbFtzdGFydERhdGUsIHN0YXJ0RGF0ZSArIHRoZXJhcGV1dGljRHVyYXRpb24gLSAxIGRheV0KTk9URTogVGhlcmFwZXV0aWMgZHVyYXRpb24gbmVlZHMgdG8gYmUgZXN0YWJsaXNoZWQgYW5kIHVudGlsIGEgd2F5IGlzIGltcGxlbWVudGVkIHRvCmRvIHRoYXQgYmFzZWQgb24gdGhlIG1lZGljYXRpb24sIHRoaXMgbG9naWMgaXMgaW5jb21wbGV0ZSBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkLgoqLwpkZWZpbmUgZmx1ZW50IGZ1bmN0aW9uIG1lZGljYXRpb25BZG1pbmlzdHJhdGlvblBlcmlvZChBZG1pbmlzdHJhdGlvbiAiTWVkaWNhdGlvbkFkbWluaXN0cmF0aW9uIik6CiAgQWRtaW5pc3RyYXRpb24gTQogICAgbGV0CiAgICAgIHRoZXJhcGV1dGljRHVyYXRpb246IFRoZXJhcGV1dGljRHVyYXRpb24oQWRtaW5pc3RyYXRpb24ubWVkaWNhdGlvbiksCiAgICAgIHN0YXJ0RGF0ZTogZGF0ZSBmcm9tIHN0YXJ0IG9mIEFkbWluaXN0cmF0aW9uLmVmZmVjdGl2ZQogICAgcmV0dXJuCiAgICAgIGlmIHN0YXJ0RGF0ZSBpcyBub3QgbnVsbCBhbmQgdGhlcmFwZXV0aWNEdXJhdGlvbiBpcyBub3QgbnVsbCB0aGVuCiAgICAgICAgSW50ZXJ2YWxbc3RhcnREYXRlLCBzdGFydERhdGUgKyB0aGVyYXBldXRpY0R1cmF0aW9uIC0gMV0KICAgICAgZWxzZQogICAgICAgIG51bGwKCi8qCk5vdyB0aGF0IHdlIGhhdmUgZnVuY3Rpb25zIGZvciBkZXRlcm1pbmluZyB0aGUgbWVkaWNhdGlvbiBwZXJpb2QgZm9yIGluZGl2aWR1YWwKcHJlc2NyaXB0aW9ucywgYWRtaW5pc3RyYXRpb25zLCBhbmQgZGlzcGVuc2VzLCB3ZSBjYW4gY29tYmluZSB0aG9zZSB1c2luZwphbiBvdmVyYWxsIGN1bXVsYXRpdmUgbWVkaWNhdGlvbiBkdXJhdGlvbiBjYWxjdWxhdGlvbi4KVGhlcmUgYXJlIHR3byBicm9hZCBhcHByb2FjaGVzIHRvIGNhbGN1bGF0aW5nIGN1bXVsYXRpdmUgZHVyYXRpb24sIG9uZSB0aGF0IF9jb2xsYXBzZXNfCm92ZXJsYXBwaW5nIGludGVydmFscyBzbyB0aGF0IGNhbGN1bGF0aW9ucyBhcmUgbm90IGR1cGxpY2F0ZWQsIGFuZCBvbmUgdGhhdCBfcm9sbHMgb3V0XwpvdmVybGFwcGluZyBpbnRlcnZhbHMgc28gdGhhdCB0aGUgZHVyYXRpb25zIGFyZSBsYWlkIGVuZC10by1lbmQuCkZpcnN0LCB3ZSBkZWZpbmUgYSBmdW5jdGlvbiB0aGF0IHNpbXBseSBjYWxjdWxhdGVzIEN1bXVsYXRpdmVEdXJhdGlvbiBvZiBhIHNldCBvZgppbnRlcnZhbHM6CiovCmRlZmluZSBmdW5jdGlvbiBDdW11bGF0aXZlRHVyYXRpb24oSW50ZXJ2YWxzIExpc3Q8SW50ZXJ2YWw8RGF0ZT4+KToKICAgaWYgSW50ZXJ2YWxzIGlzIG5vdCBudWxsIHRoZW4gKCBTdW0oKGNvbGxhcHNlIEludGVydmFscyBwZXIgZGF5KVgKICAgICAgICByZXR1cm4gYWxsKGRpZmZlcmVuY2UgaW4gZGF5cyBiZXR3ZWVuIHN0YXJ0IG9mIFggYW5kIAogICAgICAgICAgZW5kIG9mIFgKICAgICAgICApKyAxCiAgICApCiAgKSAKICAgIGVsc2UgbnVsbAoKIC8qCk5vdyB0aGF0IHdlIGhhdmUgZnVuY3Rpb25zIGZvciBkZXRlcm1pbmluZyB0aGUgbWVkaWNhdGlvbiBwZXJpb2QgZm9yIGluZGl2aWR1YWwKcHJlc2NyaXB0aW9ucywgYWRtaW5pc3RyYXRpb25zLCBhbmQgZGlzcGVuc2VzLCB3ZSBjYW4gY29tYmluZSB0aG9zZSB1c2luZwphbiBvdmVyYWxsIGN1bXVsYXRpdmUgbWVkaWNhdGlvbiBkdXJhdGlvbiBjYWxjdWxhdGlvbi4KVGhlcmUgYXJlIHR3byBicm9hZCBhcHByb2FjaGVzIHRvIGNhbGN1bGF0aW5nIGN1bXVsYXRpdmUgZHVyYXRpb24sIG9uZSB0aGF0IF9jb2xsYXBzZXNfCm92ZXJsYXBwaW5nIGludGVydmFscyBzbyB0aGF0IGNhbGN1bGF0aW9ucyBhcmUgbm90IGR1cGxpY2F0ZWQsIGFuZCBvbmUgdGhhdCBfcm9sbHMgb3V0XwpvdmVybGFwcGluZyBpbnRlcnZhbHMgc28gdGhhdCB0aGUgZHVyYXRpb25zIGFyZSBsYWlkIGVuZC10by1lbmQuCkZpcnN0LCB3ZSBkZWZpbmUgYSBmdW5jdGlvbiB0aGF0IHNpbXBseSBjYWxjdWxhdGVzIEN1bXVsYXRpdmVEdXJhdGlvbiBvZiBhIHNldCBvZgppbnRlcnZhbHM6CiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gY3VtdWxhdGl2ZUR1cmF0aW9uKEludGVydmFscyBMaXN0PEludGVydmFsPERhdGU+Pik6CiAgIGlmIEludGVydmFscyBpcyBub3QgbnVsbCB0aGVuICggU3VtKChjb2xsYXBzZSBJbnRlcnZhbHMgcGVyIGRheSlYCiAgICAgICAgcmV0dXJuIGFsbChkaWZmZXJlbmNlIGluIGRheXMgYmV0d2VlbiBzdGFydCBvZiBYIGFuZCAKICAgICAgICAgIGVuZCBvZiBYCiAgICAgICAgKSsgMQogICAgKQogICkgCiAgICBlbHNlIG51bGwKCiAvKgpOZXh0LCB3ZSBkZWZpbmUgYSBmdW5jdGlvbiB0aGF0IHJvbGxzIG91dCBpbnRlcnZhbHM6CiovCmRlZmluZSBmdW5jdGlvbiBSb2xsb3V0SW50ZXJ2YWxzKGludGVydmFscyBMaXN0PEludGVydmFsPERhdGU+Pik6CiBpbnRlcnZhbHMgSSBhZ2dyZWdhdGUgYWxsIFIgc3RhcnRpbmcgKCBudWxsIGFzIExpc3Q8SW50ZXJ2YWw8RGF0ZT4+KTogUgogICAgdW5pb24gKCB7IEkgWAogICAgICAgIGxldCBTOiBNYXgoeyAKICAgICAgICAgIGVuZCBvZiBMYXN0KFIpKyAxIGRheSwgc3RhcnQgb2YgWCB9CiAgICAgICAgKSwKICAgICAgICBFOiBTICsgUXVhbnRpdHkoQ29hbGVzY2UoZHVyYXRpb24gaW4gZGF5cyBvZiBYLCAwKSwgJ2RheScpCiAgICAgICAgcmV0dXJuIEludGVydmFsW1MsIEVdfQogICAgKQoKICAvKgpOZXh0LCB3ZSBkZWZpbmUgYSBmdW5jdGlvbiB0aGF0IHJvbGxzIG91dCBpbnRlcnZhbHM6CiovCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gcm9sbG91dEludGVydmFscyhpbnRlcnZhbHMgTGlzdDxJbnRlcnZhbDxEYXRlPj4pOgogaW50ZXJ2YWxzIEkgYWdncmVnYXRlIGFsbCBSIHN0YXJ0aW5nICggbnVsbCBhcyBMaXN0PEludGVydmFsPERhdGU+Pik6IFIKICAgIHVuaW9uICggeyBJIFgKICAgICAgICBsZXQgUzogTWF4KHsgCiAgICAgICAgICBlbmQgb2YgTGFzdChSKSsgMSBkYXksIHN0YXJ0IG9mIFggfQogICAgICAgICksCiAgICAgICAgRTogUyArIFF1YW50aXR5KENvYWxlc2NlKGR1cmF0aW9uIGluIGRheXMgb2YgWCwgMCksICdkYXknKQogICAgICAgIHJldHVybiBJbnRlcnZhbFtTLCBFXX0KICAgICkKCi8qClRoZW4sIHdlIGRlZmluZSBhIGZ1bmN0aW9uIHRoYXQgYWxsb3dzIHVzIHRvIGNhbGN1bGF0ZSBiYXNlZCBvbiB0aGUgdmFyaW91cyBtZWRpY2F0aW9uCnR5cGVzOgoqLwoKZGVmaW5lIGZ1bmN0aW9uIE1lZGljYXRpb25QZXJpb2QoCiAgbWVkaWNhdGlvbiBDaG9pY2U8Ik1lZGljYXRpb25SZXF1ZXN0IiwKICAgICJNZWRpY2F0aW9uRGlzcGVuc2UiCiAgPik6CiAgY2FzZQogICAgd2hlbiBtZWRpY2F0aW9uIGlzIE1lZGljYXRpb25SZXF1ZXN0IHRoZW4gTWVkaWNhdGlvblJlcXVlc3RQZXJpb2QobWVkaWNhdGlvbikKICAgIHdoZW4gbWVkaWNhdGlvbiBpcyBNZWRpY2F0aW9uRGlzcGVuc2UgdGhlbiBNZWRpY2F0aW9uRGlzcGVuc2VQZXJpb2QobWVkaWNhdGlvbikKICAgIGVsc2UgbnVsbAogIGVuZAoKIC8qClRoZW4sIHdlIGRlZmluZSBhIGZ1bmN0aW9uIHRoYXQgYWxsb3dzIHVzIHRvIGNhbGN1bGF0ZSBiYXNlZCBvbiB0aGUgdmFyaW91cyBtZWRpY2F0aW9uCnR5cGVzOgoqLwoKZGVmaW5lIGZsdWVudCBmdW5jdGlvbiBtZWRpY2F0aW9uUGVyaW9kKAogIG1lZGljYXRpb24gQ2hvaWNlPCJNZWRpY2F0aW9uUmVxdWVzdCIsCiAgICAiTWVkaWNhdGlvbkRpc3BlbnNlIgogID4pOgogIGNhc2UKICAgIHdoZW4gbWVkaWNhdGlvbiBpcyBNZWRpY2F0aW9uUmVxdWVzdCB0aGVuIG1lZGljYXRpb24ubWVkaWNhdGlvblJlcXVlc3RQZXJpb2QoKQogICAgd2hlbiBtZWRpY2F0aW9uIGlzIE1lZGljYXRpb25EaXNwZW5zZSB0aGVuIG1lZGljYXRpb24ubWVkaWNhdGlvbkRpc3BlbnNlUGVyaW9kKCkKICAgIGVsc2UgbnVsbAogIGVuZAoKLyoKV2UgY2FuIHRoZW4gdXNlIHRoaXMgZnVuY3Rpb24sIGNvbWJpbmVkIHdpdGggdGhlIE1lZGljYXRpb25EdXJhdGlvbiBmdW5jdGlvbnMgYWJvdmUKdG8gY2FsY3VsYXRlIEN1bXVsYXRpdmUgTWVkaWNhdGlvbiBEdXJhdGlvbjoKR2VuZXJhbGx5IHNwZWFraW5nLCB3ZSB3YW50IHRvIF9yb2xsIG91dF8gaW50ZXJ2YWxzIGZyb20gZGlzcGVuc2UgYW5kIGFkbWluaXN0cmF0aW9uCmV2ZW50cywgYW5kIHRoZW4gY29sbGFwc2UgYWNyb3NzIHRoYXQgcmVzdWx0IGFuZCBpbnRlcnZhbHMgZnJvbSBwcmVzY3JpcHRpb25zLgpOb3RlIGFsc28gdGhhdCB0aGUgc2VwYXJhdGlvbiBvZiBtZWRpY2F0aW9ucyBieSB0eXBlIHNob3VsZCBhbHJlYWR5IGJlIGRvbmUKYnkgdGhpcyBzdGFnZSBhcyB3ZWxsLgpDYWxjdWxhdGlvbnMgdGhhdCBjb21iaW5lIGRvc2FnZXMgZnJvbSBkaWZmZXJlbnQgdHlwZXMgb2YgbWVkaWNhdGlvbnMgKHN1Y2ggYXMgTW9ycGhpbmUgTWlsbGlncmFtIEVxdWl2YWxlbnQgKE1NRSkKb3IgQXZlcmFnZSBNTUUpIHJlcXVpcmUgZnVydGhlciBjb25zaWRlcmF0aW9uLgoqLwoKZGVmaW5lIGZ1bmN0aW9uIEN1bXVsYXRpdmVNZWRpY2F0aW9uRHVyYXRpb24oCiAgTWVkaWNhdGlvbnMgTGlzdDxDaG9pY2U8Ik1lZGljYXRpb25SZXF1ZXN0IiwKICAgICJNZWRpY2F0aW9uRGlzcGVuc2UiCiAgPj4pOgogIEN1bXVsYXRpdmVEdXJhdGlvbigoCiAgICAgIE1lZGljYXRpb25zIE0KICAgICAgICB3aGVyZSBNIGlzIE1lZGljYXRpb25SZXF1ZXN0CiAgICAgICAgcmV0dXJuIE1lZGljYXRpb25SZXF1ZXN0UGVyaW9kKE0pCiAgICApCiAgICAgIHVuaW9uICgKICAgICAgICBSb2xsb3V0SW50ZXJ2YWxzKAogICAgICAgICAgTWVkaWNhdGlvbnMgTQogICAgICAgICAgICB3aGVyZSBNIGlzIE1lZGljYXRpb25EaXNwZW5zZQogICAgICAgICAgICByZXR1cm4gTWVkaWNhdGlvbkRpc3BlbnNlUGVyaW9kKE0pCiAgICAgICAgKQogICAgICApCiAgKQoKIC8qCldlIGNhbiB0aGVuIHVzZSB0aGlzIGZ1bmN0aW9uLCBjb21iaW5lZCB3aXRoIHRoZSBNZWRpY2F0aW9uRHVyYXRpb24gZnVuY3Rpb25zIGFib3ZlCnRvIGNhbGN1bGF0ZSBDdW11bGF0aXZlIE1lZGljYXRpb24gRHVyYXRpb246CkdlbmVyYWxseSBzcGVha2luZywgd2Ugd2FudCB0byBfcm9sbCBvdXRfIGludGVydmFscyBmcm9tIGRpc3BlbnNlIGFuZCBhZG1pbmlzdHJhdGlvbgpldmVudHMsIGFuZCB0aGVuIGNvbGxhcHNlIGFjcm9zcyB0aGF0IHJlc3VsdCBhbmQgaW50ZXJ2YWxzIGZyb20gcHJlc2NyaXB0aW9ucy4KTm90ZSBhbHNvIHRoYXQgdGhlIHNlcGFyYXRpb24gb2YgbWVkaWNhdGlvbnMgYnkgdHlwZSBzaG91bGQgYWxyZWFkeSBiZSBkb25lCmJ5IHRoaXMgc3RhZ2UgYXMgd2VsbC4KQ2FsY3VsYXRpb25zIHRoYXQgY29tYmluZSBkb3NhZ2VzIGZyb20gZGlmZmVyZW50IHR5cGVzIG9mIG1lZGljYXRpb25zIChzdWNoIGFzIE1vcnBoaW5lIE1pbGxpZ3JhbSBFcXVpdmFsZW50IChNTUUpCm9yIEF2ZXJhZ2UgTU1FKSByZXF1aXJlIGZ1cnRoZXIgY29uc2lkZXJhdGlvbi4KKi8KCmRlZmluZSBmbHVlbnQgZnVuY3Rpb24gY3VtdWxhdGl2ZU1lZGljYXRpb25EdXJhdGlvbigKTWVkaWNhdGlvbnMgTGlzdDxDaG9pY2U8Ik1lZGljYXRpb25SZXF1ZXN0IiwKIk1lZGljYXRpb25EaXNwZW5zZSIKPj4pOgooKApNZWRpY2F0aW9ucyBNCndoZXJlIE0gaXMgTWVkaWNhdGlvblJlcXVlc3QKcmV0dXJuIE0ubWVkaWNhdGlvblJlcXVlc3RQZXJpb2QoKQopCnVuaW9uICgKKApNZWRpY2F0aW9ucyBNCndoZXJlIE0gaXMgTWVkaWNhdGlvbkRpc3BlbnNlCnJldHVybiBNLm1lZGljYXRpb25EaXNwZW5zZVBlcmlvZCgpCikucm9sbG91dEludGVydmFscygpCikKKS5jdW11bGF0aXZlRHVyYXRpb24oKQogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwovKiBGdW5jdGlvbnMgaW4gdGhpcyByZWdpb24gYXJlIGNvcGllZCBmcm9tIG9waW9pZC1tbWUtcjQgICAgICAgICAgICAgKi8KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgpkZWZpbmUgZnVuY3Rpb24gUXVhbnRpdHkodmFsdWUgRGVjaW1hbCwgdW5pdCBTdHJpbmcpOgogIGlmIHZhbHVlIGlzIG5vdCBudWxsIHRoZW4KICAgIFN5c3RlbS5RdWFudGl0eSB7IHZhbHVlOiB2YWx1ZSwgdW5pdDogdW5pdCB9CiAgZWxzZQogICAgbnVsbA=="
  } ]
}